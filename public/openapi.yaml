openapi: 3.0.0
info:
  title: MITRE ATT&CK Mapper API
  description: Maps cybersecurity scenarios and logs to MITRE ATT&CK techniques using Gemini AI.
  version: 1.0.0
# IMPORTANT: Update this URL to your actual Vercel App URL
servers:
  - url: https://mitre-attack-mapper.vercel.app
    description: Production Server
paths:
  /api/analyze:
    post:
      summary: Analyze Threat Scenario
      description: Sends text input to the AI agent to extract MITRE ATT&CK techniques, tactics, and risk scores.
      operationId: analyzeScenario
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                input:
                  type: string
                  description: The log line, threat report, or scenario description.
                  example: "Powershell.exe downloading a malicious script from external IP."
                isBulk:
                  type: boolean
                  description: Set to true if the input contains multiple distinct scenarios.
                  default: false
      responses:
        '200':
          description: Successful analysis
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    summary:
                      type: string
                    primary_tactic:
                      type: string
                    overall_risk_score:
                      type: number
                    mappings:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                          name:
                            type: string
                          confidence:
                            type: string
        '401':
          description: Unauthorized (Invalid API Key)
        '500':
          description: Server Error

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key